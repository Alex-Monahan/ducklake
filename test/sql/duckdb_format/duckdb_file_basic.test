# name: test/sql/duckdb_format/duckdb_file_basic.test
# description: Test DuckDB file format as data files for DuckLake
# group: [duckdb_format]

require ducklake

require parquet

# Test: basic DuckLake create/insert/select with default parquet format
statement ok
ATTACH 'ducklake:__TEST_DIR__/duckdb_fmt_test.ducklake' AS test_dl (DATA_PATH '__TEST_DIR__/duckdb_fmt_data');

statement ok
USE test_dl;

# Default format should work (parquet)
statement ok
CREATE TABLE test_pq (id INTEGER, name VARCHAR);

statement ok
INSERT INTO test_pq VALUES (1, 'alice'), (2, 'bob'), (3, 'charlie');

query II
SELECT * FROM test_pq ORDER BY id;
----
1	alice
2	bob
3	charlie

query I
SELECT count(*) FROM test_pq;
----
3

statement ok
DROP TABLE test_pq;

statement ok
USE memory;

statement ok
DETACH test_dl;
